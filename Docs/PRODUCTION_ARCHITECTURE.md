# üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ PassDesk –¥–ª—è Production (VPS)

## üéØ –†–µ–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

**–†–∞–∑–≤–µ—Ä–Ω—É—Ç –Ω–∞ VPS FirstVDS**
- **–î–æ–º–µ–Ω:** passdesk.fvds.ru
- **IP —Å–µ—Ä–≤–µ—Ä–∞:** 185.200.179.0
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:** passdesk
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ö–æ—Å—Ç–∏–Ω–≥–æ–º:** ISPManager

## –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

PassDesk –≤ production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ **–ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –≤–µ–±-—Å–∏—Å—Ç–µ–º–∞** –Ω–∞ –µ–¥–∏–Ω–æ–º VPS —Å —á–µ—Ç—ã—Ä—å–º—è –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏:

1. **–§—Ä–æ–Ω—Ç–µ–Ω–¥** - React/Vite (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã)
2. **–ë—ç–∫–µ–Ω–¥** - Node.js/Express (API —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É 5000)
3. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - PostgreSQL (Yandex Cloud)
4. **–•—Ä–∞–Ω–∏–ª–∏—â–µ** - S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ (Cloud.ru)

---

## –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        –ò–ù–¢–ï–†–ù–ï–¢                                 ‚îÇ
‚îÇ                   (–ë—Ä–∞—É–∑–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ HTTPS 443
                           ‚îÇ passdesk.fvds.ru
                           ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ    VPS Server (FirstVDS)             ‚îÇ
        ‚îÇ  IP: 185.200.179.0                   ‚îÇ
        ‚îÇ  –û–°: Linux (Ubuntu/Debian)           ‚îÇ
        ‚îÇ  –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: ISPManager              ‚îÇ
        ‚îÇ                                      ‚îÇ
        ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
        ‚îÇ  ‚îÇ   Nginx (–≤–µ–±-—Å–µ—Ä–≤–µ—Ä)            ‚îÇ ‚îÇ
        ‚îÇ  ‚îÇ   Reverse Proxy                 ‚îÇ ‚îÇ
        ‚îÇ  ‚îÇ                                 ‚îÇ ‚îÇ
        ‚îÇ  ‚îÇ  ‚Ä¢ HTTPS/SSL (Let's Encrypt)    ‚îÇ ‚îÇ
        ‚îÇ  ‚îÇ  ‚Ä¢ –°—Ç–∞—Ç–∏–∫–∞ React (dist/)        ‚îÇ ‚îÇ
        ‚îÇ  ‚îÇ  ‚Ä¢ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤           ‚îÇ ‚îÇ
        ‚îÇ  ‚îÇ  ‚Ä¢ Gzip –∫–æ–º–ø—Ä–µ—Å—Å–∏—è              ‚îÇ ‚îÇ
        ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
        ‚îÇ           ‚îÇ                          ‚îÇ
        ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
        ‚îÇ  ‚îÇ  Node.js (localhost:5000)        ‚îÇ ‚îÇ
        ‚îÇ  ‚îÇ  Express —Å–µ—Ä–≤–µ—Ä (pm2)            ‚îÇ ‚îÇ
        ‚îÇ  ‚îÇ                                  ‚îÇ ‚îÇ
        ‚îÇ  ‚îÇ  ‚Ä¢ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (JWT)          ‚îÇ ‚îÇ
        ‚îÇ  ‚îÇ  ‚Ä¢ API endpoints (/api/v1/*)     ‚îÇ ‚îÇ
        ‚îÇ  ‚îÇ  ‚Ä¢ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞                ‚îÇ ‚îÇ
        ‚îÇ  ‚îÇ  ‚Ä¢ CORS middleware               ‚îÇ ‚îÇ
        ‚îÇ  ‚îÇ  ‚Ä¢ Rate limiting                 ‚îÇ ‚îÇ
        ‚îÇ  ‚îÇ  ‚Ä¢ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤          ‚îÇ ‚îÇ
        ‚îÇ  ‚îÇ  ‚Ä¢ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞–º–∏ (S3)       ‚îÇ ‚îÇ
        ‚îÇ  ‚îÇ  ‚Ä¢ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫              ‚îÇ ‚îÇ
        ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
        ‚îÇ           ‚îÇ                          ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ TCP 5432
                    ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ               ‚îÇ                  ‚îÇ             ‚îÇ
    ‚ñº               ‚ñº                  ‚ñº             ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇPostgreSQL  ‚îÇ S3        ‚îÇ        ‚îÇSyslog  ‚îÇ   ‚îÇBackup    ‚îÇ
‚îÇDatabase   ‚îÇ Storage   ‚îÇ        ‚îÇ        ‚îÇ   ‚îÇService   ‚îÇ
‚îÇ(Yandex    ‚îÇ(Cloud.ru) ‚îÇ        ‚îÇ        ‚îÇ   ‚îÇ          ‚îÇ
‚îÇCloud)     ‚îÇ –∏–ª–∏       ‚îÇ        ‚îÇ        ‚îÇ   ‚îÇ          ‚îÇ
‚îÇ           ‚îÇYandex     ‚îÇ        ‚îÇ        ‚îÇ   ‚îÇ          ‚îÇ
‚îÇ‚Ä¢ employees‚îÇCloud S3   ‚îÇ        ‚îÇ        ‚îÇ   ‚îÇ          ‚îÇ
‚îÇ‚Ä¢ passes   ‚îÇ           ‚îÇ        ‚îÇ        ‚îÇ   ‚îÇ          ‚îÇ
‚îÇ‚Ä¢ users    ‚îÇ‚Ä¢ Documents‚îÇ        ‚îÇ        ‚îÇ   ‚îÇ          ‚îÇ
‚îÇ‚Ä¢ files    ‚îÇ‚Ä¢ Photos   ‚îÇ        ‚îÇ        ‚îÇ   ‚îÇ          ‚îÇ
‚îÇ‚Ä¢ logs     ‚îÇ‚Ä¢ Reports  ‚îÇ        ‚îÇ        ‚îÇ   ‚îÇ          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### 1. –í–µ–±-—Å–µ—Ä–≤–µ—Ä (Nginx)

**–†–æ–ª—å:** –û–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏, —Ä–∞–∑–¥–∞—á–∞ —Å—Ç–∞—Ç–∏–∫–∏, SSL/TLS termination

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `/etc/nginx/vhosts/passdesk/passdesk.fvds.ru.conf`

**–ü—É—Ç—å —Å—Ç–∞—Ç–∏–∫–∏:** `/var/www/passdesk/data/www/passdesk.fvds.ru/`

**–õ–æ–≥–∏:** `/var/www/httpd-logs/passdesk.fvds.ru.*.log`

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
```
‚úì HTTPS/SSL termination (Let's Encrypt)
‚úì –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (React dist)
‚úì –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ /api/* –Ω–∞ Node.js
‚úì –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (js, css, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
‚úì Gzip –∫–æ–º–ø—Ä–µ—Å—Å–∏—è
‚úì –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∏ –æ—à–∏–±–æ–∫
‚úì –û–±—Ä–∞–±–æ—Ç–∫–∞ SPA (React Router)
‚úì –õ–∏–º–∏—Ç—ã —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤ (100M)
```

**–ü—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞:**

```
–ó–∞–ø—Ä–æ—Å: GET https://yourdomain.com/api/v1/employees

1. Nginx –ø–æ–ª—É—á–∞–µ—Ç HTTPS –∑–∞–ø—Ä–æ—Å (–ø–æ—Ä—Ç 443)
2. –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç SSL (–∏—Å–ø–æ–ª—å–∑—É—è fullchain.pem)
3. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç path: /api/v1/...
4. –ú–∞—Ç—á–∏—Ç location /api/
5. –ü—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –Ω–∞ http://localhost:5000/api/v1/...
   (–ø—Ä–æ–∫—Å–∏—Ä—É–µ–º—ã–π –∑–∞–ø—Ä–æ—Å: GET http://localhost:5000/api/v1/employees)
6. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏:
   - Host: yourdomain.com
   - X-Real-IP: client-ip
   - X-Forwarded-For: client-ip, proxy-ip
   - X-Forwarded-Proto: https
7. –ü–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç –æ—Ç Node.js
8. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç—É —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏: Content-Encoding: gzip (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è):**

```nginx
server {
    listen 443 ssl;
    server_name yourdomain.com www.yourdomain.com;

    # SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ—Ç Let's Encrypt
    ssl_certificate /etc/letsencrypt/live/yourdomain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/yourdomain.com/privkey.pem;

    # –ö–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏ React
    root /var/www/passdesk/dist;
    index index.html;

    # ===== API Proxy =====
    location /api/ {
        proxy_pass http://localhost:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_read_timeout 30s;
        proxy_connect_timeout 30s;
    }

    # ===== React SPA =====
    location / {
        try_files $uri $uri/ /index.html;
    }

    # ===== –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫–∏ =====
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

---

### 2. –ë—ç–∫–µ–Ω–¥ —Å–µ—Ä–≤–µ—Ä (Node.js/Express)

**–†–æ–ª—å:** API —Å–µ—Ä–≤–µ—Ä, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `/var/www/passdesk/data/passdesk/server/`

**–ü—Ä–æ—Ü–µ—Å—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** PM2 (Process Manager v6.0.13)

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** passdesk

**–ü–æ—Ä—Ç:** 5000 (cluster mode, 2 –ø—Ä–æ—Ü–µ—Å—Å–∞)

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**

```
‚úì JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤)
‚úì CORS middleware (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–æ—Å—Å-–¥–æ–º–µ–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏)
‚úì –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (express-validator)
‚úì CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î (—á–µ—Ä–µ–∑ Sequelize ORM)
‚úì –ó–∞–≥—Ä—É–∑–∫–∞/—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ (S3 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
‚úì –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ (morgan)
‚úì –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (—É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)
‚úì –°–∂–∞—Ç–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ (compression middleware)
‚úì Rate limiting
‚úì Health check endpoint (/health)
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞:**

```
server/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ server.js                   # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.js             # Sequelize –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ storage.js              # S3 –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cors.js                 # CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.js                 # JWT –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ errorHandler.js         # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ validation.js           # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.js                # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.js                 # POST /auth/*
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ employees.js            # CRUD /employees/*
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ passes.js               # CRUD /passes/*
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ files.js                # POST /files/upload, GET /files/download
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ admin.js                # –ê–¥–º–∏–Ω –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ User.js                 # Sequelize –º–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Employee.js             # Sequelize –º–æ–¥–µ–ª—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Pass.js                 # Sequelize –º–æ–¥–µ–ª—å –ø—Ä–æ–ø—É—Å–∫–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ File.js                 # Sequelize –º–æ–¥–µ–ª—å —Ñ–∞–π–ª–∞
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ authService.js          # –õ–æ–≥–∏–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ employeeService.js      # –õ–æ–≥–∏–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ passService.js          # –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fileService.js          # –õ–æ–≥–∏–∫–∞ —Ñ–∞–π–ª–æ–≤ (S3)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ errorService.js         # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jwt.js                  # –†–∞–±–æ—Ç–∞ —Å JWT —Ç–æ–∫–µ–Ω–∞–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ validators.js           # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ helpers.js              # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ database/
‚îÇ       ‚îî‚îÄ‚îÄ migrations/             # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ ecosystem.config.js             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pm2
```

**–ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∑–∞–ø—Ä–æ—Å–∞:**

```
–ó–∞–ø—Ä–æ—Å: POST https://yourdomain.com/api/v1/employees/123/upload

1. Nginx –ø–æ–ª—É—á–∞–µ—Ç HTTPS –∑–∞–ø—Ä–æ—Å –∏ –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –Ω–∞ localhost:5000
2. Express –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –æ—Ç Nginx

3. middleware/auth.js:
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ Authorization: Bearer <token>
   - –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç JWT —Ç–æ–∫–µ–Ω
   - –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç req.user = { id, role, ... }
   - –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401 Unauthorized

4. middleware/validation.js:
   - –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (req.body, req.params, req.files)
   - –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 400 Bad Request

5. routes/employees.js (–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –º–∞—Ä—à—Ä—É—Ç–∞):
   - –í—ã–∑—ã–≤–∞–µ—Ç employeeService.uploadFiles()

6. services/employeeService.js:
   - –û–±–Ω–æ–≤–ª—è–µ—Ç –∑–∞–ø–∏—Å—å –≤ –ë–î
   - –í—ã–∑—ã–≤–∞–µ—Ç fileService.uploadToS3()

7. services/fileService.js:
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª –Ω–∞ S3
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç signed URL –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è

8. middleware/errorHandler.js (–µ—Å–ª–∏ –æ—à–∏–±–∫–∞):
   - –õ–æ–≥–∏—Ä—É–µ—Ç –æ—à–∏–±–∫—É
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON –æ—Ç–≤–µ—Ç —Å –∫–æ–¥–æ–º 400/500

9. Nginx –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç (JSON)
10. Nginx —Å–∂–∏–º–∞–µ—Ç –æ—Ç–≤–µ—Ç (gzip)
11. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç—É —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ Content-Encoding: gzip
```

**–û–∫—Ä—É–∂–∞—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–Ω–∞ VPS –≤ `/var/www/passdesk/data/passdesk/server/.env`):**

```env
# –û–∫—Ä—É–∂–µ–Ω–∏–µ
NODE_ENV=production
PORT=5000
API_VERSION=v1

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (Yandex Cloud)
DB_HOST=rc1b-r05alhnj8s89jsb8.mdb.yandexcloud.net
DB_PORT=6432
DB_NAME=dbsu10
DB_USER=wstil
DB_PASSWORD=Ae1T...
DB_SSL=true

# CORS & –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
ALLOWED_ORIGINS=https://passdesk.fvds.ru,https://www.passdesk.fvds.ru
CLIENT_URL=https://passdesk.fvds.ru

# S3 –•—Ä–∞–Ω–∏–ª–∏—â–µ (Cloud.ru)
STORAGE_PROVIDER=cloudru
CLOUDRU_S3_ENDPOINT=https://s3.cloud.ru
CLOUDRU_S3_REGION=ru-central-1
CLOUDRU_S3_ACCESS_KEY_ID=75b5873d-08f3-4815-b059-e26dc32412dc:e9a17a2bbaef0a8cf7259decf9b23b27
CLOUDRU_S3_SECRET_ACCESS_KEY=8f65eb0...
CLOUDRU_S3_BUCKET_NAME=passdesk
CLOUDRU_S3_BASE_PATH=

# JWT
JWT_SECRET=dev_secret_key_change_in_production_12345
JWT_EXPIRE=7d
JWT_REFRESH_SECRET=dev_refresh_token_secret_67890
JWT_REFRESH_EXPIRE=30d

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
LOG_LEVEL=debug
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PM2 (`ecosystem.config.cjs`):**
```javascript
// 2 –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ cluster mode –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏
instances: 2
exec_mode: 'cluster'
error_file: '/var/www/passdesk/data/logs/error.log'
out_file: '/var/www/passdesk/data/logs/out.log'
```

---

### 3. –§—Ä–æ–Ω—Ç–µ–Ω–¥ (React/Vite)

**–†–æ–ª—å:** SPA (Single Page Application), –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ (—Å–æ–±—Ä–∞–Ω–Ω—ã–π –∫–æ–¥):** `/var/www/passdesk/data/www/passdesk.fvds.ru/`

**–ò—Å—Ç–æ—á–Ω–∏–∫ (–∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥):** `/var/www/passdesk/data/passdesk/client/`

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**

```
‚úì React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (Feature-Sliced Design)
‚úì React Router –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
‚úì API –∫–ª–∏–µ–Ω—Ç (axios)
‚úì State management (Zustand)
‚úì Ant Design –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚úì Responsive design (desktop, tablet, mobile)
‚úì –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (JWT –≤ localStorage)
‚úì –ó–∞–≥—Ä—É–∑–∫–∞/—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
‚úì –¢–∞–±–ª–∏—Ü—ã –∏ —Å–ø–∏—Å–∫–∏ –¥–∞–Ω–Ω—ã—Ö
‚úì –§–æ—Ä–º—ã —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
```

**–ü—Ä–æ—Ü–µ—Å—Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:**

```
1. –ë—Ä–∞—É–∑–µ—Ä –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç https://yourdomain.com
2. Nginx –æ—Ç–¥–∞–µ—Ç index.html –∏–∑ /var/www/passdesk/dist/
3. HTML –∑–∞–≥—Ä—É–∂–∞–µ—Ç main.js (bundled React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
4. React –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è:
   - –°–æ–∑–¥–∞–µ—Ç root component
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç Auth Store –∏–∑ localStorage
   - –ï—Å–ª–∏ JWT —Ç–æ–∫–µ–Ω –µ—Å—Ç—å:
     - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET /api/v1/auth/me (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Å—Å–∏–∏)
     - –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
     - –†–µ–Ω–¥–∏—Ä–∏—Ç –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
   - –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω–∞ –Ω–µ—Ç:
     - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–æ–≥–∏–Ω–∞
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
6. React –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ API —á–µ—Ä–µ–∑ axios
7. –ó–∞–≥–æ–ª–æ–≤–æ–∫ Authorization: Bearer <token> –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

**–û–∫—Ä—É–∂–∞—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–≤ `.env.local` –ª–æ–∫–∞–ª—å–Ω–æ, –≤ `vite.config.js` –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ):**

```env
# –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (.env.local)
VITE_API_URL=http://localhost:5000/api
VITE_API_VERSION=v1

# Production (–≤—à–∏—Ç–æ –≤ index.html —á–µ—Ä–µ–∑ Nginx –∏–ª–∏ —Å–±–æ—Ä–∫–∞)
# –ü—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è /api/* –∏ –±—Ä–∞—É–∑–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–µ—Ä–µ—Ç —Ç–µ–∫—É—â–∏–π –¥–æ–º–µ–Ω
```

**API –∑–∞–ø—Ä–æ—Å—ã (–ø—Ä–∏–º–µ—Ä—ã):**

```javascript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤:
// POST https://yourdomain.com/api/v1/auth/login

POST /api/v1/auth/login
Body: { email, password }
Response: { token, user: { id, email, role } }

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–æ–∫:
// Authorization: Bearer <token –∏–∑ localStorage>

GET /api/v1/employees
Headers: Authorization: Bearer <token>
Response: { employees: [...] }

POST /api/v1/employees
Headers: Authorization: Bearer <token>
Body: { firstName, lastName, phone, ... }
Response: { employee: { id, ... } }

// –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
POST /api/v1/employees/123/upload
Headers: Authorization: Bearer <token>
Body: FormData { file: <File> }
Response: { file: { id, name, url } }
```

---

### 4. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)

**–†–æ–ª—å:** –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** Yandex Managed Service for PostgreSQL (—É–¥–∞–ª–µ–Ω–Ω–∞—è)

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:**

```sql
-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)
users (
  id UUID PRIMARY KEY,
  email VARCHAR UNIQUE,
  password_hash VARCHAR,
  role ENUM('admin', 'manager', 'user'),
  created_at TIMESTAMP,
  updated_at TIMESTAMP
)

-- –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏
employees (
  id UUID PRIMARY KEY,
  last_name VARCHAR NOT NULL,
  first_name VARCHAR NOT NULL,
  middle_name VARCHAR,
  phone VARCHAR,
  email VARCHAR,
  position_id UUID,
  citizenship_id UUID,
  birth_date DATE,
  passport_number VARCHAR,
  inn VARCHAR,
  snils VARCHAR,
  status_card ENUM('draft', 'active', 'inactive'),
  is_fired BOOLEAN,
  created_at TIMESTAMP,
  updated_at TIMESTAMP
)

-- –ü—Ä–æ–ø—É—Å–∫–∞
passes (
  id UUID PRIMARY KEY,
  number VARCHAR UNIQUE,
  employee_id UUID REFERENCES employees(id),
  status ENUM('draft', 'issued', 'revoked'),
  issue_date DATE,
  expiry_date DATE,
  created_at TIMESTAMP,
  updated_at TIMESTAMP
)

-- –§–∞–π–ª—ã (—Å—Å—ã–ª–∫–∏ –Ω–∞ S3)
files (
  id UUID PRIMARY KEY,
  employee_id UUID REFERENCES employees(id),
  file_name VARCHAR,
  file_size INTEGER,
  s3_key VARCHAR,  -- –ö–ª—é—á –≤ S3 —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
  s3_url VARCHAR,  -- –ü–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π URL
  created_at TIMESTAMP,
  updated_at TIMESTAMP
)
```

**–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:**

```
Host: rc1a-c7...yandex.net
Port: 6432
Database: passdesk_prod
User: passdesk_admin
SSL: Required (TLS)
```

---

### 5. –•—Ä–∞–Ω–∏–ª–∏—â–µ —Ñ–∞–π–ª–æ–≤ (S3)

**–†–æ–ª—å:** –û–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ —Ñ–∞–π–ª–æ–≤

**–ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã:**
- Cloud.ru S3
- Yandex Cloud Object Storage
- AWS S3 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:**

```javascript
// –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
PUT /passdesk-files/employees/123/passport.pdf
Body: <file binary>
Result: S3 Key = "employees/123/passport.pdf"

// –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ URL (–¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è)
GET /passdesk-files?Action=GetObject&Key=employees/123/passport.pdf
Result: URL = "https://storage.yandex.../passdesk-files/employees/123/passport.pdf?X-Amz-Signature=..."
Expiry: 1 —á–∞—Å

// –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
DELETE /passdesk-files/employees/123/passport.pdf
Result: –§–∞–π–ª —É–¥–∞–ª–µ–Ω
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–Ω–∞ VPS):**

```env
S3_ENDPOINT=https://storage.yandexcloud.net
S3_REGION=ru-central1
S3_ACCESS_KEY=YCAJ...
S3_SECRET_KEY=YCP...
S3_BUCKET=passdesk-files
```

---

## –ü—Ä–æ—Ü–µ—Å—Å—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç email/–ø–∞—Ä–æ–ª—å
         ‚Üì
React –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST /api/v1/auth/login
         ‚Üì
Nginx –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –Ω–∞ localhost:5000
         ‚Üì
Express middleware: auth check (–ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç, —Ç.–∫. –Ω–µ—Ç —Ç–æ–∫–µ–Ω–∞)
         ‚Üì
authController.login():
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç email –≤ –ë–î (PostgreSQL)
  - –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –ø–∞—Ä–æ–ª—å (bcrypt)
  - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç JWT —Ç–æ–∫–µ–Ω (–ø–æ–¥–ø–∏—Å–∞–Ω JWT_SECRET)
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç { token, user }
         ‚Üì
React –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–∫–µ–Ω –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ localStorage
         ‚Üì
React –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Å Authorization: Bearer <token>
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

```
React –≤—ã–∑—ã–≤–∞–µ—Ç GET /api/v1/employees
         ‚Üì
–ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å Authorization: Bearer <token>
         ‚Üì
Nginx –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –Ω–∞ localhost:5000
         ‚Üì
Express middleware: auth.js
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ Authorization –∑–∞–≥–æ–ª–æ–≤–∫–∞
  - –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç JWT —Ç–æ–∫–µ–Ω (JWT_SECRET)
  - –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç req.user = { id, role, ... }
  - –ï—Å–ª–∏ –æ—à–∏–±–∫–∞: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401
         ‚Üì
employeeController.getAll():
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)
  - –í—ã–ø–æ–ª–Ω—è–µ—Ç SQL query: SELECT * FROM employees
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
         ‚Üì
Nginx —Å–∂–∏–º–∞–µ—Ç –æ—Ç–≤–µ—Ç (gzip)
         ‚Üì
React –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∏ —Ä–µ–Ω–¥–∏—Ä–∏—Ç —Ç–∞–±–ª–∏—Ü—É
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Ñ–∞–π–ª –≤ React
         ‚Üì
React –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST /api/v1/employees/123/upload (FormData)
Headers: Authorization: Bearer <token>
         ‚Üì
Nginx –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –Ω–∞ localhost:5000
         ‚Üì
Express middleware:
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–∫–µ–Ω
  - –ü–∞—Ä—Å–∏—Ç FormData (multer middleware)
         ‚Üì
fileController.upload():
  - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç S3 key: "employees/123/passport_1234567.pdf"
  - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –Ω–∞ S3 (AWS SDK)
  - –ü–æ–ª—É—á–∞–µ—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π URL –æ—Ç S3
  - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑–∞–ø–∏—Å—å –≤ –ë–î (files —Ç–∞–±–ª–∏—Ü–∞)
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç { file_id, s3_url, file_name }
         ‚Üì
React –ø–æ–ª—É—á–∞–µ—Ç URL –∏ –º–æ–∂–µ—Ç –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Ñ–∞–π–ª
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Authentication (JWT)

```
–ü—Ä–æ—Ü–µ—Å—Å:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ª–æ–≥–∏–Ω–∏—Ç—Å—è ‚Üí –ø–æ–ª—É—á–∞–µ—Ç JWT —Ç–æ–∫–µ–Ω
2. JWT —Å–æ–¥–µ—Ä–∂–∏—Ç: { sub: user_id, role: 'user', exp: 1704067200 }
3. –ü–æ–¥–ø–∏—Å–∞–Ω —Å –ø–æ–º–æ—â—å—é JWT_SECRET (—Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
4. –•—Ä–∞–Ω–∏—Ç—Å—è –≤ localStorage (–±—Ä–∞—É–∑–µ—Ä)
5. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ: Authorization: Bearer <token>
6. –°–µ—Ä–≤–µ—Ä –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω:
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å (JWT_SECRET)
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (exp)
   - –ï—Å–ª–∏ –∏—Å—Ç–µ–∫: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401 Unauthorized

–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
‚úì –¢–æ–∫–µ–Ω –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–¥–¥–µ–ª–∞–Ω (—Ç—Ä–µ–±—É–µ—Ç—Å—è JWT_SECRET)
‚úì –¢–æ–∫–µ–Ω –∏–º–µ–µ—Ç —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (7 –¥–Ω–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
‚úì –†–∞–∑–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á—É–∂–∏–µ —Ç–æ–∫–µ–Ω—ã
‚úì –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ —Ç–æ–∫–µ–Ω —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ localStorage
```

### CORS (Cross-Origin Resource Sharing)

```
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
ALLOWED_ORIGINS=https://yourdomain.com,https://www.yourdomain.com

–ü—Ä–æ—Ü–µ—Å—Å:
1. –ë—Ä–∞—É–∑–µ—Ä –Ω–∞ https://yourdomain.com –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ /api/...
2. –ë—Ä–∞—É–∑–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç CORS:
   - –¢–µ–∫—É—â–∏–π origin: https://yourdomain.com
   - –ò—â–µ—Ç –≤ ALLOWED_ORIGINS ‚úì –ù–∞–π–¥–µ–Ω–æ
3. –ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è
4. –°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç Origin –∑–∞–≥–æ–ª–æ–≤–æ–∫
5. –ï—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Access-Control-Allow-Origin: https://yourdomain.com

–ó–∞—â–∏—Ç–∞:
‚úì –ó–∞–ø—Ä–æ—Å—ã —Å –¥—Ä—É–≥–∏—Ö –¥–æ–º–µ–Ω–æ–≤ –±—É–¥—É—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –±—Ä–∞—É–∑–µ—Ä–æ–º
‚úì –¢–æ–ª—å–∫–æ —è–≤–Ω–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ origins –ø–æ–ª—É—á–∞—é—Ç –¥–æ—Å—Ç—É–ø
```

### S3 Access

```
–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
‚úì S3_ACCESS_KEY –∏ S3_SECRET_KEY –¢–û–õ–¨–ö–û –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (.env)
‚úì –ö–ª–∏–µ–Ω—Ç (–±—Ä–∞—É–∑–µ—Ä) –Ω–µ –≤–∏–¥–∏—Ç —ç—Ç–∏ –∫–ª—é—á–∏
‚úì –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å S3 –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ Express —Å–µ—Ä–≤–µ—Ä
‚úì –°–µ—Ä–≤–µ—Ä –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ URL —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (1 —á–∞—Å)

–ü–æ—Ç–æ–∫:
–ö–ª–∏–µ–Ω—Ç ‚Üí –ó–∞–ø—Ä–æ—Å –Ω–∞ upload ‚Üí –°–µ—Ä–≤–µ—Ä (—Å S3 –∫–ª—é—á–∞–º–∏) ‚Üí S3
–ö–ª–∏–µ–Ω—Ç ‚Üê URL –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è (–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π) ‚Üê –°–µ—Ä–≤–µ—Ä
```

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```
PM2 –ª–æ–≥–∏ (–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è passdesk):
- /var/www/passdesk/data/logs/error.log - –û—à–∏–±–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- /var/www/passdesk/data/logs/out.log   - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥

Nginx –ª–æ–≥–∏:
- /var/www/httpd-logs/passdesk.fvds.ru.access.log  - –í—Å–µ HTTP –∑–∞–ø—Ä–æ—Å—ã
- /var/www/httpd-logs/passdesk.fvds.ru.error.log   - –û—à–∏–±–∫–∏ Nginx

–ü—Ä–æ—Å–º–æ—Ç—Ä:
pm2 logs passdesk-server                      # –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è (–æ—Ç passdesk)
tail -f /var/www/httpd-logs/passdesk.fvds.ru.access.log  # Requests
tail -f /var/www/passdesk/data/logs/error.log # Errors
```

### Health Check

```
–≠–Ω–¥–ø–æ–∏–Ω—Ç:
GET /api/v1/health

–û—Ç–≤–µ—Ç:
{
  status: 'OK',
  timestamp: '2025-01-23T10:30:00Z',
  environment: 'production'
}

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
curl https://yourdomain.com/api/v1/health
–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 200 OK
```

---

## –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### PM2 Cluster Mode

```javascript
// ecosystem.config.js
module.exports = {
  apps: [{
    name: 'passdesk-server',
    script: './src/server.js',
    instances: 2,           // 2 –ø—Ä–æ—Ü–µ—Å—Å–∞ (–∏–ª–∏ 'max' –¥–ª—è –≤—Å–µ—Ö CPU)
    exec_mode: 'cluster',   // Cluster mode –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏
    // ...
  }]
};
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- Express –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ 2 –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö
- PM2 –±–∞–ª–∞–Ω—Å–∏—Ä—É–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –º–µ–∂–¥—É –Ω–∏–º–∏
- –ü—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥—Ä—É–≥–æ–π –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

```
Nginx –∫—ç—à–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç–∏–∫—É (js, css, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è):
- –ë—Ä–∞—É–∑–µ—Ä –∫—ç—à–∏—Ä—É–µ—Ç –Ω–∞ 1 –≥–æ–¥ (Cache-Control: max-age=31536000)
- Nginx –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ETags –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π

API –æ—Ç–≤–µ—Ç—ã:
- –ë–î –∫—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫—ç—à PostgreSQL)
- S3 –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ URLs –∫—ç—à–∏—Ä—É—é—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º (1 —á–∞—Å)
```

---

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

```
1. –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ:
   git push origin main

2. –ù–∞ VPS (–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è passdesk):
   cd /var/www/passdesk/data/passdesk
   git pull origin main

3. –ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è –±—ç–∫–µ–Ω–¥:
   cd server
   npm install
   pm2 restart passdesk-server

4. –ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥:
   cd ../client
   npm install
   npm run build
   cp -r dist/* /var/www/passdesk/data/www/passdesk.fvds.ru/
   sudo systemctl reload nginx

5. –ü—Ä–æ–≤–µ—Ä–∫–∞:
   curl http://127.0.0.1/api/v1/health
   curl http://127.0.0.1/ (–¥–æ–ª–∂–Ω–∞ –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è React app)
   
6. –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:
   pm2 logs passdesk-server --lines 50
   tail -100 /var/www/passdesk/data/logs/error.log
```

---

## Troubleshooting

| –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|
| –°–∞–π—Ç –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å nginx: `sudo nginx -t && sudo systemctl status nginx` |
| API –æ—à–∏–±–∫–∞ 502 | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å pm2: `pm2 logs passdesk-server` (–æ—Ç passdesk), –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å: `su - passdesk -c "pm2 restart passdesk-server"` |
| SSL –æ—à–∏–±–∫–∞ (–±—Ä–∞—É–∑–µ—Ä —Ä—É–≥–∞–µ—Ç—Å—è) | –≠—Ç–æ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è). –ß–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é –æ–±–Ω–æ–≤–∏–º –Ω–∞ Let's Encrypt |
| –§–∞–π–ª—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å S3 –∫–ª—é—á–∏ Cloud.ru –≤ `.env` –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ –±–∞–∫–µ—Ç |
| PM2 –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–µ –∂–∏–≤—ã | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: `su - passdesk -c "pm2 status"`, –ª–æ–≥–∏: `tail -50 /var/www/passdesk/data/logs/error.log` |
| Nginx –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–µ—Ç—Å—è | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å: `sudo nginx -t`, –∫–æ–Ω—Ñ–∏–≥: `/etc/nginx/vhosts/passdesk/passdesk.fvds.ru.conf` |

---

---

## üéØ –†–µ–∞–ª—å–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ VPS FirstVDS

### –î–∞—Ç–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è: 2025-11-24

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã VPS:
- **–î–æ–º–µ–Ω–Ω–æ–µ –∏–º—è:** passdesk.fvds.ru
- **IP –∞–¥—Ä–µ—Å:** 185.200.179.0
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:** passdesk (–æ—Ç–¥–µ–ª—å–Ω—ã–π –æ—Ç –¥—Ä—É–≥–∏—Ö —Å–∞–π—Ç–æ–≤)
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** ISPManager + BIND (DNS)

### –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
‚úÖ Git —Ä–µ–ø–æ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω —Å GitHub  
‚úÖ –§—Ä–æ–Ω—Ç–µ–Ω–¥ —Å–æ–±—Ä–∞–Ω (React/Vite ‚Üí dist/)  
‚úÖ –ë—ç–∫–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω (Node.js v18.19.1, PM2)  
‚úÖ Nginx –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–∞–∫ reverse proxy  
‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (—Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π)  
‚úÖ PM2 —É–ø—Ä–∞–≤–ª—è–µ—Ç 2 –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ Node.js  
‚úÖ –ë–î –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ (Yandex Cloud PostgreSQL)  
‚úÖ S3 —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ (Cloud.ru)  
‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ DNS –∑–∞–ø–∏—Å–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã  

### –°—Ç–∞—Ç—É—Å:
- **–§—Ä–æ–Ω—Ç–µ–Ω–¥:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (React SPA)
- **–ë—ç–∫–µ–Ω–¥:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (API –Ω–∞ /api/v1/*, –ø–æ—Ä—Ç 5000)
- **–ë–î:** ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∞ (Yandex Cloud)
- **S3:** ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω (Cloud.ru S3)
- **SSL:** ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (—Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π - –º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –Ω–∞ Let's Encrypt)
- **DNS:** ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω (—á–µ—Ä–µ–∑ ISPManager/BIND)

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ PM2 (–æ—Ç passdesk)
su - passdesk -c "pm2 status"

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
su - passdesk -c "pm2 logs passdesk-server --lines 50"
tail -50 /var/www/passdesk/data/logs/error.log

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –±—ç–∫–µ–Ω–¥–∞
su - passdesk -c "pm2 restart passdesk-server"

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ Nginx
sudo systemctl reload nginx

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞
cd /var/www/passdesk/data/passdesk
git pull origin main
```

**–í–µ—Ä—Å–∏—è:** 2.0 (—Ä–µ–∞–ª—å–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-11-24  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–∑–≤–µ—Ä–Ω—É—Ç–æ –Ω–∞ production VPS

